<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - SportIQ</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <h2>Login</h2>
      <form onsubmit="loginUser(event)">
        <div class="input-box">
          <label for="loginId">Email or Username</label>
          <input
            type="text"
            id="loginId"
            placeholder="Enter email or username"
            required
          />
        </div>
        <div class="input-box">
          <label for="loginPass">Password</label>
          <input
            type="password"
            id="loginPass"
            placeholder="Enter password"
            required
          />
        </div>
        <button type="submit" class="btn">Login</button>
      </form>

      <p id="loginMsg"></p>
      <p>
        Don’t have an account?
        <a href="register.html" class="secondary">Register</a>
      </p>
    </div>

    <!-- Import common helpers -->
    <script src="app.js"></script>
    <script>
      function loginUser(e) {
        e.preventDefault();

        const loginId = document
          .getElementById("loginId")
          .value.trim()
          .toLowerCase();
        const pass = document.getElementById("loginPass").value;
        const msg = document.getElementById("loginMsg");

        const user = getUser(); // from app.js

        if (!user) {
          msg.textContent = "⚠ No user registered yet!";
          msg.style.color = "#ef4444";
          return;
        }

        // Validate login
        if (
          (loginId === user.username?.toLowerCase() ||
            loginId === user.email?.toLowerCase()) &&
          pass === user.password
        ) {
          msg.textContent = "✅ Login successful!";
          msg.style.color = "#10b981";
          setTimeout(() => (window.location.href = "dashboard.html"), 1000);
        } else {
          msg.textContent = "❌ Invalid username/email or password!";
          msg.style.color = "#ef4444";
        }
      }
    </script>
  </body>
</html>
