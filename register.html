<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register - SportIQ</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <h2>Register</h2>
      <form onsubmit="registerUser(event)">
        <div class="input-box">
          <label for="regUsername">Username</label>
          <input type="text" id="regUsername" required />
        </div>
        <div class="input-box">
          <label for="regEmail">Email</label>
          <input type="email" id="regEmail" required />
        </div>
        <div class="input-box">
          <label for="regPass">Password</label>
          <input type="password" id="regPass" required />
        </div>
        <div class="input-box">
          <label for="regPass2">Confirm Password</label>
          <input type="password" id="regPass2" required />
        </div>
        <button type="submit" class="btn" style="background: #9333ea">
          Register
        </button>
      </form>
      <p id="msg"></p>
      <p>
        Already have an account? <a href="login.html" class="primary">Login</a>
      </p>
    </div>

    <script>
      function registerUser(e) {
        e.preventDefault();

        const username = document.getElementById("regUsername").value.trim();
        const email = document.getElementById("regEmail").value.trim();
        const pass = document.getElementById("regPass").value;
        const pass2 = document.getElementById("regPass2").value;
        const msg = document.getElementById("msg");

        // Password check
        if (pass !== pass2) {
          msg.textContent = "❌ Passwords do not match!";
          msg.style.color = "#ef4444";
          return;
        }

        // Check if already a user
        let existingUser = JSON.parse(localStorage.getItem("sportiqDetails"));
        if (
          existingUser &&
          existingUser.email &&
          existingUser.email.toLowerCase() === email.toLowerCase()
        ) {
          msg.textContent = "❌ Email already registered!";
          msg.style.color = "#ef4444";
          return;
        }

        // Save base user info to sportiqDetails
        const baseUser = {
          username,
          email,
          password: pass,
        };

        localStorage.setItem("sportiqDetails", JSON.stringify(baseUser));

        msg.textContent = "✅ Registered Successfully! Redirecting...";
        msg.style.color = "#10b981";

        // Move to details page
        setTimeout(() => (window.location.href = "details.html"), 1200);
      }
    </script>
  </body>
</html>
